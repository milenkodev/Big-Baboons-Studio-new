---
import Footer from "../components/Footer.astro";
import Nav from "../components/Nav.astro";
import "../style/Style.astro";

---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <link rel="preload" as="font" type="font/woff2" href='node_modules/@fontsource/@fontsource/atkinson-hyperlegible/400.css' crossorigin="anonymous"/>
    <link rel="preload" as="font" type="font/woff2" href='node_modules/@fontsource/@fontsource/atkinson-hyperlegible/700.css' crossorigin="anonymous"/>
    <link rel="preload" as="font" type="font/woff2" href='node_modules/@fontsource/@fontsource/prompt/900.css' crossorigin="anonymous"/>



    <title>Astro</title>
  </head>
  <body class="bg-black">
    <Nav />
    <slot />
    <div class="lastCard hidden"></div>
    <Footer />
  </body>
</html>

<script>

  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";
  gsap.registerPlugin(ScrollTrigger);
  import Lenis from "lenis";




  const lenis = new Lenis({
    duration: 2,
    touchMultiplier: 2,
  });

  function raf(time: number) {
    lenis.raf(time);
    requestAnimationFrame(raf);
  }

  requestAnimationFrame(raf);

  document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
    anchor.addEventListener("click", function (e) {
      e.preventDefault();
      lenis.scrollTo(this.getAttribute("href"));
    });
  });




    document.addEventListener('DOMContentLoaded', () => {

  let mm = gsap.matchMedia();

  mm.add("(min-width: 426px)", () => {
    const heroText = document.querySelectorAll(".hero-text");
    gsap.from(heroText, {
      delay:0.5,
      yPercent: 100,
      transformOrigin: "center",
      stagger: 0.2,
      duration: 1,
      ease: "power1",
    });

    const indexCards = document.querySelectorAll(".indexCards");
    const indexWrapper = document.querySelector(".indexWrapper");

    indexCards.forEach((section) => {
      const tlIndexCards = gsap.timeline({
        scrollTrigger: {
          trigger: section,
          start: "top top",
          // end: "bottom bottom",
          invalidateOnRefresh: true,
          scrub: true,
          // markers: true,
          pin: section,
        },
      });
      tlIndexCards
        .to(
          section,
          {
            transformOrigin: "center",
            scale: 0.5,
            duration: 4,
            ease: "power1",
          },
          0
        )
        .to(section, {
          autoAlpha: 0,
        });
    });

  
  });

    // footer
    const FooterTextUp = document.querySelectorAll(".FooterUp");

    const tlFooter = gsap.timeline({
      scrollTrigger: {
        trigger: ".lastCard",
        start: "bottom center-=200",
        end: "bottom bottom",
        scrub: 1,
        // markers: true,
      },
    });
    tlFooter
      .from(
        ".FooterUp",
        {
          yPercent: 100,
          duration: 1,
          ease: "power1",
        },
        0
      )
      .from(
        ".alter-text",
        {
          autoAlpha: 0,
          rotateY: 90,
        },
        0
      );

    gsap.from(".footer", {
      scrollTrigger: {
        trigger: ".lastCard",
        start: "start bottom",
        // end: 'bottom bottom',
        scrub: true,
        // markers: true,
      },
      opacity: 0,
      duration: 0.1,
    });
  });
</script>
